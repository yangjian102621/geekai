# 更新日志

## v3.1.7
1. Bug修复：修复 MidJourney API 参数版本更新导致调用失败的 Bug
2. 功能优化：将聊天报错信息定义为统一常量，方便修改

## v3.1.7
1. 功能新增：支持文心4.0 AI 模型
2. 功能新增：可以在管理后台为用户绑定指定的 AI 模型，如只给某个用户使用 GPT-4 模型
3. 功能新增：模型新增权重字段，不同的模型每次调用耗费的点数可以设置不同，比如GPT4是GPT3.5的10倍
4. 功能新增：新增系统配置关闭 AI 模型的函数功能
5. 功能优化：优化 MidJourney 专业绘画页面图片预览样式

## v3.1.6
1. 功能新增：新增AI 绘画照片墙功能页面，供用户查看所有的 AI 绘画作品
2. 功能新增：新增 AI 角色应用功能页面，用户可以添加自己感兴趣的应用
3. 功能优化：优化瀑布流组件的页面布局
4. 功能优化：新注册用户成功之后自动登录
5. 功能优化：优化更新对话标题的操作体验，绑定回车事件

## v3.1.5

1. 功能新增：新增百度文心一言大模型 API 接入支持
2. 功能新增：新增科大讯飞星火大模型 API 接入支持
3. 功能重构：将 chat_handler 的所有功能实现放入单独的包中
4. 功能新增：新增系统配置 `enabled_function` 用于启用和关闭函数功能
5. Bug修复：修复管理后台更新 API Key 失败的 Bug
6. Bug修复：修复新建的对话无法更新对话标题的 Bug
7. 功能优化：其他一些小的体验优化工作

## v3.1.4

1. 功能新增：新增阿里云 OSS 图片上传实现，目前已支持本地存储，七牛云，Minio和阿里云 OSS 四种存储介质。
2. 功能新增：**增加 Stable Diffusion 绘画功能页面**。
3. 功能重构：将 [chatgpt-plus-exts](https://github.com/yangjian102621/chatgpt-plus-exts) 合并到本项目，部署更加简单，无需部署两个项目了。
4. Bug修复：修复[用户注册报错BUG #37](https://github.com/yangjian102621/chatgpt-plus/issues/37)。
5. Bug修复：修复 MidJourney API 接口升级导致图片文保存失败的 Bug。
6. 功能优化：增加阿里云短信服务配置项 `Sign` 和 `CodeTempId` 用来配置自己的短信签名和短信验证码模版 ID。
7. 功能优化：添加系统配置用来设置自定义的众筹微信收款二维码。
8. 功能优化：优化绘画页面的弹窗样式和页面布局。

## v3.1.3

1. 页面重构：重后 Home 页面，拆分成聊天，MJ绘画，SD 绘画，应用广场等多个功能菜单。
2. 功能新增：新增 MidJourney 专业绘画页面，开放更高级的 MJ 绘画姿势。
3. 功能优化：采用队列的方式控制绘画任务并发，简化任务回调通知逻辑，给任务回调加锁。
4. 功能优化：精简用户表字段，删除用户名和昵称，只保留手机号。
5. 功能优化：优化文件上传服务工厂实现，只创建激活的 Uploader 服务，节省资源。
6. Bug修复：修复 JWT token 有效期计算错误的 Bug。

## v3.1.2

1. 功能新增：新增七牛云 OSS 实现，目前已支持三种文件上传服务：Local, Minio, QiNiu OSS。
2. 功能新增：新增桌面版，使用 electron 套壳网页版。
3. Bug修复：自动去除众筹核销时候转账单号中的空格，防止复制的时候多复制了空格。
4. 功能优化：ChatPlus.vue 页面支持通过 chat_id path variable 来定位到指定的聊天。
5. 功能优化：取消导出聊天页面的授权验证
6. 功能优化：所有路由跳转都使用绝对路径

## v3.1.1

紧急修复版本，采用弹窗的方式显示验证码，解决验证码在低分辨率下被掩盖的Bug

## v3.1.0(大版本更新)

1. 功能重构：将聊天模型独立拆分，以便支持多平台模型，目前已经内置支持 OPenAI，Azure 以及
   ChatGLM，用户可以在这两个平台的模型中随意切换，体验不同的模型聊天。
2. 功能重构：重写系统 API 授权机制，使用 JWT 替换传统的 session 会话授权，使得 API 授权变得更加灵活。
3. 功能重构：重构文件夹上传服务，支持多种文件上传存储handler，目前已经实现本地存储和 minio oss 存储。
4. 功能优化：更新头像自动删除旧的图片资源。
5. 功能优化：将应用日志在终端输出的同时存盘，方便 docker 部署查看日志。
6. 功能新增：允许用户配置自己的 OPenAI，Azure 以及 ChatGLM API KEY。
7. 功能优化：优化移动版的行为验证码样式，修复低分辨率显示器验证码被遮挡的 Bug
8. 升级 gin, element-plus，redis 组件到最新版本。
9. Bug修复：修复若干已知的的 Bug

## v3.0.7

1. 聊天主界面：新增聊天引导页面，介绍产品功能
2. 功能重构：拆分项目，将函数插件以及微信机器人，MidJourney 机器人等功能拆分新项目独立部署。
3. 功能新增：新增 MidJourney AI 绘画支持，当识别到用户的绘画需求时，自动调用 MidJourney 绘画函数进行绘画。
4. 功能新增：支持导出聊天记录为 PDF 文件。
5. 功能优化：在后台 dashboard 页面新增统计今日众筹收入。
6. 功能优化：支持用户设置默认的 GPT 模型
7. Bug修复：修复若干已知的的 Bug

## v3.0.6

1. 管理后台：新增用户名和手机号码搜索功能
2. 管理后台：新增重置用户密码功能
3. 管理后台：支持关闭注册功能，新增添加用户功能，适用于内部使用场景
4. 管理后台：新增仪表盘页面，统计当天的新增用户，新增会话数据，以及 Token 消耗
5. Bug修复：修复注册页面验证码不显示 Bug
6. Bug修复：优化上下文 Token 计算算法，修复聊天上下文超出限制时循环发送消息的 Bug
7. 功能修正：允许用户使用手机号码登录
8. 功能优化：更新系统配置后同步更新服务端内存变量数据
9. 功能优化：优化打包脚本，减少容器镜像大小

## v3.0.5

重磅功能更新！！！ 新增函数插件支持，可以轻松地接入你的第三方插件服务，ChatGPT 自动帮您调用对应的函数完成任务。

1. 新增函数功能支持，全球早报，今日头条和微博热搜等插件服务，您也可以接入自己的第三方服务。
2. 集成微信机器人模块，可以通过微信个人收款码来完成充值，无需接入微信支付功能也可以完成收款功能。
3. 用户注册添加短信验证码功能，引入交互安全认证服务，有效防刷短信。
4. 支持配置聊天上下文深度，精确统计每轮对话所消耗的总 TOKEN 数量。
5. 修复已知的 Bug。

## v3.0.4

1. 调整项目目录结构，移除其他语言 API 目录
2. 修复 nodejs apple M1 跨平台打包，运行报错 exec format error
3. 增加用户 token 消耗统计功能

## v3.0.3

1. 优化启动参数接收处理，支持环境变量传参
2. 修复 PC 端聊天界面出现滚动条的 Bug
3. 修正前端 user_init_call 字段错误和用户注册初始化头像路径问题
4. 更改 docker 构建镜像的基础镜像，改用作者的阿里云镜像，这样打包更快一些。

## v3.0.2

1. Feat：新增移动端的聊天和用户设置功能
2. Fix: 修复 markdown 换行符解析的 Bug
3. Feat: 新增头像上传功能
4. Docs: 增加容器部署支持，支持 docker-compose 一键部署
5. Fix: 增加全局错误处理 handler，修复业务处理异常导致服务退出的 Bug

## v3.0.1

1. 紧急修复前端 Home 组件路由被后台管理 Home 组件路由覆盖的 Bug。
2. 增加 docker-compose 部署脚本

## v3.0.0

全新的重构版本！！！
新版的系统前后端都进行大改动的重构，后端还是用的 Gin Web 框架，但是作者整合了 fx 自动注入框架，整个后端应用结构非常简洁，特别适合二次开发。
另外，数据存储用 MySQL 替换了 leveldb, 因为要对 C 端，后期会涉及到很多业务数据查询统计，leveldb 已经完全不够用了。
前后台技术架构还是基于 `Vue3 + Element-Plus` ，但是页面风格已经全部变了，几乎所有页面样式代码都重写了，希望会你是希望的风格！

此次重构改版主要是为了后面功能的扩展准备了。

新版本已经实现的功能如下：

1. 引入用户体系，新增用户注册和登录功能。
2. 聊天页面改版，实现了跟 ChatGPT 官方版本一致的聊天体验。
3. 创建会话的时候可以选择聊天角色和模型。
4. 新增聊天设置功能，用户可以导入自己的 API KEY
5. 保存聊天记录，支持聊天上下文。
6. 重构后台管理模块，更友好，扩展性更好的后台管理系统。
7. 引入 ip2region 组件，记录用户的登录IP和地址。
8. 支持会话搜索过滤。